<section>
  <div class=" rounded-full p-4 border border-white m-4 w-60 flex justify-center items-center mx-auto">
    <%= image_tag "bird.png", alt: "photo de profil", class:"rounded-full" %>
  </div>

  <%# info  %>
  <div class="flex flex-col items-center">
    <div class="m-4 flex flex-col items-center">
      <h2 class="text-3xl font-semibold mb-4">Info personnel</h2>
      <span><strong>Mail : </strong><%= current_user.email %></span>

      <hr class="border border-[#c59f60] w-[60%] mx-auto m-4">
      <div class="mt-2">
        <h3 class="text-xl font-semibold mb-2 text-center">Informations de <%= current_user.dog.name %></h3>
        <div class="flex flex-col gap-1">
          <% if current_user.dog.species.present? %>
            <span><strong>Race : </strong><%= current_user.dog.species %></span>
          <% end %>
          <% if current_user.dog.date_of_birth.present? %>
            <span><strong>Date de naissance : </strong><%= l(current_user.dog.date_of_birth, format: :long, locale: :fr) %></span>
          <% end %>
          <% if current_user.dog.description.present? %>
            <span><strong>Description : </strong><%= current_user.dog.description %></span>
          <% end %>
        </div>
      </div>
    </div>

    <div class="m-4 flex items-center">
      <button class="flex items-center gap-2 rounded-full bg-amber-500 p-2 text-black font-bold text-sm" onclick="dog_edit_modal.showModal()">
        <span class="pl-2"><%= current_user.dog.name %></span>
        <%= image_tag "edit.png", alt: "Modifier le profil", class: "w-6 h-6" %>
      </button>
    </div>

    <%# Modal d'édition du chien %>
    <dialog id="dog_edit_modal" class="modal">
      <div class="modal-box">
        <form method="dialog">
          <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
        </form>
        <h3 class="text-lg font-bold text-center mb-2">Modifier les informations de <%= current_user.dog.name %></h3>
        <hr class="border border-[#c59f60] w-[60%] mx-auto m-2">

        <%= simple_form_for(current_user.dog, url: dog_path, method: :patch) do |f| %>
          <%= f.input :name, 
              label: 'Nom du chien',
              label_html: { class: '!text-[#db924b]' },
              input_html: { 
                class: '!bg-transparent/20 mt-2 border border-[#db924b] rounded-lg p-2 mb-2 text-zinc-400'
              } %>

          <%= f.input :species, 
              label: 'Race',
              label_html: { class: '!text-[#db924b]' },
              input_html: { 
                class: '!bg-transparent/20 mt-2 border border-[#db924b] rounded-lg p-2 mb-2 text-zinc-400'
              } %>

          <%= f.input :date_of_birth, 
              label: 'Date de naissance',
              label_html: { class: '!text-[#db924b]' },
              input_html: { 
                class: '!bg-transparent/20 mt-2 border border-[#db924b] rounded-lg p-2 mb-2 text-zinc-400',
                type: 'date'
              } %>

          <%= f.input :description, 
              label: 'Description',
              label_html: { class: '!text-[#db924b]' },
              input_html: { 
                class: '!bg-transparent/20 mt-2 border border-[#db924b] rounded-lg p-2 mb-2 text-zinc-400',
                rows: 4
              } %>

          <div class="flex justify-center gap-4 mt-4">
            <%= f.button :submit, 'Enregistrer', class: 'btn btn-primary' %>
            <button type="button" class="btn btn-secondary" onclick="dog_edit_modal.close()">Annuler</button>
          </div>
        <% end %>
      </div>
    </dialog>

    <hr class="border border-[#c59f60] w-[60%] mx-auto m-4">


    <%# les prochaines balades inscrit%>
    <div class=" text-center">
      <h2 class="text-3xl font-semibold">Prochaines balades</h2>
      <% current_user.walks.each do |walk| %>
        <div class="m-4 flex flex-col items-center">
          <div class="flex justify-center items-center gap-2">
            <span class="font-semibold"><%= walk.name %> - </span>
            <span class="mr-4"><%= l(walk.date, format: :short, locale: :fr) %></span>


            <% if walk.user_walks.exists?(user: current_user) %>
              <%=
    link_to destroy_user_walk_path(walk_id: walk.id),
              data: { 
                turbo_method: :delete, 
                turbo_frame: "_top", 
                turbo_confirm: "Voulez-vous vraiment vous désinscrire de cette balade ?" 
              } do %>
                <%= image_tag "trash3.svg", alt: "Icône de suppression", width: 20, height: 20 %>
              <% end %>
            <% end %>

          </div>
        </div>
      <% end %>

      <%# bouton de déconnexion %>
      <div class="flex justify-center">
        <%= link_to "Se déconnecter", destroy_user_session_path, class:"btn btn-primary m-4 flex mx-auto", data: { turbo_method: :delete }%>
      </div>
    </div>
  </div>

</section>
